info:
  name: forgame-test
  description: 4game Test
  version: "2.1"
  category: facade
  owner:
    name: Dmitry Kulikov
    email: kulikov.dm@gmail.com

include:
  - file: samza-task.yml

build:
  - sh: "mkdir -p target/pack && touch target/pack/index.txt"
  - sbt-pack: {}
  - marathon: {}
  - sh: "echo 'Hello, World!'"
  - debian:
      install-root: "/local/innova/www-versions"
      daemon-args: "echo Start"
      service-owner: "innova"
      daemon-user: "innova"
      daemon: "no"
      daemon-port:
      make-pidfile: "false"
      distribution: "unstable"

test: &some_test
  hello: a {{ vars.hello }}
  name: Dima
  new ? {{ vars.env }}:
    qa: Dima-Qa
    live: Dima-Live
    dev: Dima-Dev

deploy:
  marathon:
    instances: 3
    mem: 512
    cpu: 1
    cmd: "bin/mesos-start"
    constraints: "kidz:true"

  debian:
    cluster ? {{ vars.env }}:
      qa: cpb-new.qa.inn.ru
      live: cpb.lux.inn.eu

release:
  routes:
    - host ? {{vars.branch}}-{{vars.env}}:
        "-live": "~^(.+\\.)?kidzite.space$;"
        "-qa": "~^(.+\\.)?kidzite.qa$;"
        "*": "{{vars.branch}}.kidzite.qa"
      location: /

result:
  << : *some_test
  surname: kulikov
  name: Misha
