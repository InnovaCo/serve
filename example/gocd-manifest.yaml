---
  gocd:
    config: &config
      login: "{{ vars.login }}"
      password: "{{ vars.password }}"
      url: https://go.inn.ru/go/api/admin/pipelines
      pipeline_name: gocd_test

    delete: *config

    change:
      <<: *config
      pipeline:
        group: other
        pipeline:
          name: "{{ gocd.config.pipeline_name }}"
          template: left-right-site-tpl
          label_template: "${COUNT}"
          parameters:
            - name: project
              value: inn-gocd_test

            - name: repo.url
              value: git@github.inn.ru:tools/LookOnce.git

            - name: qa-cluster
              value: otplink1-q.qa.inn.ru

            - name: live-cluster

            - name: site
              value: lookonce

            - name: version
              value: 1.0

            - name: deploy-attrs
              value: --marker-source=pid:/var/run/innova/inn-lookonce.pid

            - name: qa-tests-arg
          environment_variables:
            - name: SHA

            - name: BRANCH
              value: master
              secure: false

            - name: GITHUB_TOKEN
              encrypted_value: NusYoj7M3l2vGqZo8ro8sakI8bLKQO2gqH1/AN3mUKt42DGaM7P8YS1L46rus4UL
              secure: true
          materials:
            - type: git
              attributes:
                url: "#{repo.url}"
                destination: sources





